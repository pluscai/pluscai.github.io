<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
   	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
    <meta name="renderer" content="webkit">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/index.css">
    <script src="js/jquery-1.11.0.min.js"></script>
    <title>标桥课堂-新增页面</title>
</head>
<body>
	<div class="manager-wrap">
		<img class="managebg" src="images/managebg.png" alt="" />
		<ul>
			<li>
				<a href="#">
					<div class="manager-top">
						<div class="manager-icon manager-icon1"></div>
						<p class="manager-txt">点我演奏新年好(速度自定)</p>
					</div>
					<div class="shadow"></div>
				</a>
				
			</li>
			
		</ul>
	</div>
	<script>
		$(".manager-wrap").height($(window).height());
		$(window).resize(function(){
			$(".manager-wrap").height($(window).height());
		});
		
		
		window.AudioContext = window.AudioContext || window.webkitAudioContext;	
		if(!window.AudioContext) {
			alert("你的浏览器不支持 WEB Audio API，换个浏览器或者升级试试吧~");
			
		}

		var $btn = $('.manager-wrap li');

		var audioCtx = new AudioContext();

		// 发出的声音频率数据，表现为音调的高低
		var arrFrequency = [523.25,523.25,523.25,391.09,
							659.25,659.25,659.25,523.25,
							523.25,659.25,783.09,783.09,698.46,659.25,587.33,
							587.33,659.25,698.46,698.46,
							659.25,587.33,659.25,523.25,
							523.25,659.25,587.33,391.99,
							493.88,587.33,523.25
						];
		
		var start = 0;
		
		var os = function() {  
		     var ua = navigator.userAgent,  
		     isWindowsPhone = /(?:Windows Phone)/.test(ua),  
		     isSymbian = /(?:SymbianOS)/.test(ua) || isWindowsPhone,   
		     isAndroid = /(?:Android)/.test(ua),   
		     isFireFox = /(?:Firefox)/.test(ua),   
		     isChrome = /(?:Chrome|CriOS)/.test(ua),  
		     isTablet = /(?:iPad|PlayBook)/.test(ua) || (isAndroid && !/(?:Mobile)/.test(ua)) || (isFireFox && /(?:Tablet)/.test(ua)),  
		     isPhone = /(?:iPhone)/.test(ua) && !isTablet,  
		     isPc = !isPhone && !isAndroid && !isSymbian;  
		     return {  
		          isTablet: isTablet,  
		          isPhone: isPhone,  
		          isAndroid : isAndroid,  
		          isPc : isPc  
		     };  
		}();  
		var mousedown1,mouseup1;
		if(os.isAndroid || os.isPhone){
			mousedown1='touchstart';
			mouseup1='touchend'
		}else if(os.isPc) {
			mousedown1='mousedown';
			mouseup1='mouseup'
		}
		
		$btn[mousedown1](function(){
			$(this).addClass('active');
			
				var frequency = arrFrequency[start];
				if(!frequency){
					start = 0;
					frequency = arrFrequency[start];
				}
				start++;
				// 创建音调控制对象
				var oscillator = audioCtx.createOscillator();
				// 创建音量控制对象
				var gainNode = audioCtx.createGain();
				// 音调音量关联
				oscillator.connect(gainNode);
				// 音量和设备关联
				gainNode.connect(audioCtx.destination);
				// 音色类型指定为正弦波
				oscillator.type = 'sine';
				// 设置音频频率
				oscillator.frequency.value = frequency;
				
				
				// 先把当前音量设为0
				gainNode.gain.setValueAtTime(0,audioCtx.currentTime);
				// 声音音量线性从0到1
				gainNode.gain.linearRampToValueAtTime(1,audioCtx.currentTime+0.01);
				// 声音走起
				oscillator.start(audioCtx.currentTime);
				
				// 0.5秒时间内音量指数曲线变为0.01
				gainNode.gain.exponentialRampToValueAtTime(0.01,audioCtx.currentTime +0.5);
				// 关闭声音
				oscillator.stop(audioCtx.currentTime + 0.5);
		});
		$btn[mouseup1](function(){
			$(this).removeClass('active');
		});
		
		

			
	
	</script>
</body>
</html>
