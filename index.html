<!DOCTYPE 
html>
<html lang="zh-CN">

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=Edge">
		<meta name="renderer" content="webkit">
		<link rel="stylesheet" href="css/common.css">
		<link rel="stylesheet" href="css/index.css">
		<script src="js/jquery-1.11.0.min.js"></script>
		<title></title>
	</head>

	<body>
		<button id="button">两只老虎</button>
		<script type="text/javascript">
			window.AudioContext = window.AudioContext || window.webkitAudioContext;
			(function() {
				if(!window.AudioContext) {
					alert("你的浏览器不支持 WEB Audio API，换个浏览器或者升级试试吧~");
					return;
				}

				var btn = document.getElementById("button");

				var audioCtx = new AudioContext();

				// 发出的声音频率数据，表现为音调的高低
				var arrFrequency = [261.63, 293.66, 329.63, 261.63, 261.63, 293.66, 329.63, 261.63, 329.63, 
				349.23, 392.00, 329.63, 249.23, 392.00, 392.00, 440.00, 392.00, 349.23, 329.23, 261.63, 392.00,
				440.00, 392.00, 349.23, 329.63, 261.63, 293.66, 196.00, 261.63, 293.66, 196.00, 264.63];
				
				var start = 0;
				
				btn.addEventListener('click',function(){
					var frequency = arrFrequency[start];
					if(!frequency){
						start = 0;
						frequency = arrFrequency[start];
					}
					start++;
					// 创建音调控制对象
					var oscillator = audioCtx.createOscillator();
					// 创建音量控制对象
					var gainNode = audioCtx.createGain();
					// 音调音量关联
					oscillator.connect(gainNode);
					// 音量和设备关联
					gainNode.connect(audioCtx.destination);
					// 音色类型指定为正弦波
					oscillator.type = 'sine';
					// 设置音频频率
					oscillator.frequency.value = frequency;
					
					
					// 先把当前音量设为0
					gainNode.gain.setValueAtTime(0,audioCtx.currentTime);
					// 声音音量线性从0到1
					gainNode.gain.linearRampToValueAtTime(1,audioCtx.currentTime+0.01);
					// 声音走起
					oscillator.start(audioCtx.currentTime);
					
					// 0.5秒时间内音量指数曲线变为0.01
					gainNode.gain.exponentialRampToValueAtTime(0.01,audioCtx.currentTime +0.5);
					// 关闭声音
					oscillator.stop(audioCtx.currentTime + 0.5);
				});
				
				
				
				
			})();
		</script>

		<!--<script src="js/index.js"></script>-->
	</body>

</html>
